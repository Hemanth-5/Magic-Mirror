{
  "version": 2,
  "builds": [
    { "src": "api/index.py", "use": "@vercel/python" },
    { "src": "my-app/**/*.js", "use": "@vercel/node", "config": { 
      "build": {
        "env": {
          "OBFUSCATE": "true"
        },
        "commands": [
          "if [ \"$OBFUSCATE\" = \"true\" ]; then npx javascript-obfuscator ./my-app/build/static/js/*.js --output ./my-app/build/static/js/ --compact true --self-defending true; fi"
        ]
      }
    }}
  ],
  "routes": [
    { "src": "/(.*)", "dest": "/api/index.py" }
  ],
  "buildCommand": "npm install javascript-obfuscator --no-save && cd my-app && npm run build"
}
